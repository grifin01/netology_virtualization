# Домашнее задание к занятию 3. «Введение. Экосистема. Архитектура. Жизненный цикл Docker-контейнера»


## Задача 1

Сценарий выполнения задачи:

- создайте свой репозиторий на https://hub.docker.com;
- выберите любой образ, который содержит веб-сервер Nginx;
- создайте свой fork образа;
- реализуйте функциональность:
запуск веб-сервера в фоне с индекс-страницей, содержащей HTML-код ниже:
```
<html>
<head>
Hey, Netology
</head>
<body>
<h1>I’m DevOps Engineer!</h1>
</body>
</html>
```

Опубликуйте созданный fork в своём репозитории и предоставьте ответ в виде ссылки на https://hub.docker.com/username_repo.

## Ответ

https://hub.docker.com/r/denvish98/virt-03-docker

## Задача 2

Посмотрите на сценарий ниже и ответьте на вопрос:
«Подходит ли в этом сценарии использование Docker-контейнеров или лучше подойдёт виртуальная машина, физическая машина? Может быть, возможны разные варианты?»

Детально опишите и обоснуйте свой выбор.

--

Сценарий:

- высоконагруженное монолитное Java веб-приложение;
- Nodejs веб-приложение;
- мобильное приложение c версиями для Android и iOS;
- шина данных на базе Apache Kafka;
- Elasticsearch-кластер для реализации логирования продуктивного веб-приложения — три ноды elasticsearch, два logstash и две ноды kibana;
- мониторинг-стек на базе Prometheus и Grafana;
- MongoDB как основное хранилище данных для Java-приложения;
- Gitlab-сервер для реализации CI/CD-процессов и приватный (закрытый) Docker Registry.

## Ответ

- Высоконагруженное монолитное java веб-приложение -  данный сценарий нереализуем в микропроцессорной архитектуре без нарушения целостности кода, вдобавок приложение является высоконагруженным, поэтому лучше всего использовать физический сервер.
- Nodejs веб-приложение - node.js является частью javascript и описывает логику работы веб-приложения, такой сценарий укладывается в микросервисную архитектуру и применения контейнеризации.
- Мобильное приложение c версиями для Android и iOS - пользователю необходим UI для взаимодействия с мобильным устройством, поэтому подошла бы виртуальная машина.
- Шина данных на базе Apache Kafka - сервис необходим для трансляции данных, здесь применима контейнеризация. Простота масштабирования и управления достижмы ввиду отсутствия накладных расходов на виртуализацию.
- Elasticsearch кластер для реализации логирования продуктивного веб-приложения - для продуктового решения лучше использовать виртуализацию, а вопрос отказоустойчивости решить путем создания HA кластера гипервизоров. В тестовой среде можно развернуть сервисы в  контейнерах, что позволит сэкономить временной ресурс.
- Мониторинг-стек на базе Prometheus и Grafana -для разворачивания сервисов можно использовать контейнеризацию, т.к. это дает возможность гибкого масштабирования и экономит время.
- MongoDB, как основное хранилище данных для java-приложения - можно использовать как виртуализацию, так и контейнеризацию. Выбор будет зависеть от количества и частоты обращений к БД.
- Gitlab сервер для реализации CI/CD процессов и приватный (закрытый) Docker Registry -  подойдет как физический сервер, так и виртуализация. Предварительно необходимо провести анализ имеющейся аппаратной составляющей на предмет его использования в перспективе роста нагрузки на ЦПУ, ОЗУ, увеличение данных на накопителях.

## Задача 3

- Запустите первый контейнер из образа ***centos*** c любым тегом в фоновом режиме, подключив папку ```/data``` из текущей рабочей директории на хостовой машине в ```/data``` контейнера.
- Запустите второй контейнер из образа ***debian*** в фоновом режиме, подключив папку ```/data``` из текущей рабочей директории на хостовой машине в ```/data``` контейнера.
- Подключитесь к первому контейнеру с помощью ```docker exec``` и создайте текстовый файл любого содержания в ```/data```.
- Добавьте ещё один файл в папку ```/data``` на хостовой машине.
- Подключитесь во второй контейнер и отобразите листинг и содержание файлов в ```/data``` контейнера.

## Ответ
- Запустите первый контейнер из образа ***centos*** c любым тегом в фоновом режиме, подключив папку ```/data``` из текущей рабочей директории на хостовой машине в ```/data``` контейнера:
```
vish@DevOps:~/Netology/devops-netology/docker_tasks/05-virt-03-docker$ docker run -it -d --name centos -v $(pwd)/data:/data centos:latest
Unable to find image 'centos:latest' locally
latest: Pulling from library/centos
a1d0c7532777: Pull complete 
Digest: sha256:a27fd8080b517143cbbbab9dfb7c8571c40d67d534bbdee55bd6c473f432b177
Status: Downloaded newer image for centos:latest
5af1a070d07f8fc8e2c37e444ba9d2cc00164bfccd7a32c987efe31475de15a6
```
- Запустите второй контейнер из образа ***debian*** в фоновом режиме, подключив папку ```/data``` из текущей рабочей директории на хостовой машине в ```/data``` контейнера:
```
vish@DevOps:~/Netology/devops-netology/docker_tasks/05-virt-03-docker$ docker run -it -d --name debian -v $(pwd)/data:/data debian:latest
Unable to find image 'debian:latest' locally
latest: Pulling from library/debian
bc0734b949dc: Pull complete 
Digest: sha256:bac353db4cc04bc672b14029964e686cd7bad56fe34b51f432c1a1304b9928da
Status: Downloaded newer image for debian:latest
61b4c4eb054dd1fb942951f47d1bdfd3d96f7cd1de6a1b0aa7323a06cb511c9e
```

- Подключитесь к первому контейнеру с помощью ```docker exec``` и создайте текстовый файл любого содержания в ```/data```:
```
vish@DevOps:~/Netology/devops-netology/docker_tasks/05-virt-03-docker$ docker exec -it centos bash
[root@5af1a070d07f /]# echo "Hi, it's Netology task" >> /data/welcome.txt
[root@5af1a070d07f /]# exit
```

- Добавьте ещё один файл в папку ```/data``` на хостовой машине:
```
vish@DevOps:~/Netology/devops-netology/docker_tasks/05-virt-03-docker$ echo "And this is the host" >> ./data/host.txt
```

- Подключитесь во второй контейнер и отобразите листинг и содержание файлов в ```/data``` контейнера:
```
vish@DevOps:~/Netology/devops-netology/docker_tasks/05-virt-03-docker$ docker exec -it debian bash
root@61b4c4eb054d:/# ls /data/
host.txt  welcome.txt
```






## Задача 4 (*)

Воспроизведите практическую часть лекции самостоятельно.

Соберите Docker-образ с Ansible, загрузите на Docker Hub и пришлите ссылку вместе с остальными ответами к задачам.
